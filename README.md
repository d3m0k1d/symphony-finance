# symphony-finance

Пускай ваши банки сольются в единую мелодию!

# front end

- https://github.com/nikitaLomeiko/vtb-api-hack_2025

# структура проекта

Мы стараемся придерживаться [стандартного макета проекта](https://github.com/golang-standards/project-layout)

- `/internal/api/uberproxy/` -- основной пакет HTTP API, позволяющий авторизованным пользователям выполнять запросы к upstream API банков от своего имени
- `/cmd/uberproxy/` -- исполняемый uberproxy и composition root
- `/migrations/` -- миграции SQLite для [goose](https://github.com/pressly/goose)
	- `/default_banks.sql` -- скрипт для инициализации БД с 3 банками из песочницы
- `/client-pilot` -- OpenBanking-клиенты API сгенерированные с помощью [oapi-codegen](https://github.com/oapi-codegen/oapi-codegen)
  - собрать: `go generate ./client-pilot/`
- `/internal/client/` -- [в активной разработке] удобный API-клиент поверх клиентов сгенерированных из oas
  - `/internal/client/hack` -- реализация клиента с учётом особенностей sandbox-банков: отсутствующие или дополнительные поля, нестандартные consent’ы и аутентификация
  - `/internal/client/gost` -- реализация, строго соответствующая стандартам
- `/internal/multibank/` -- мультибанковский клиент для агрегирования данных из нескольких банков. Сейчас единственная функция -- объединённый список транзакций
- `/internal/config/` -- интерфейс конфигурации и провайдеры, основанные на переменных окружения или реляционных БД
- `/internal/otp/` -- сервис отвечающий OTP
- `/internal/mail/` -- почтовый клиент для отправки OTP
  - `impl` -- реальный SMTP-клиент
  - `fake` -- мок с логированием кодов для разработки
- `do.sh` -- bash-скрипт для автоматизации процесса разработки.

# дорожная карта

## готово 9 ноября

- проксирование запросов в upstream
- получение сохранение соглашений на доступ
- OTP auth
- динамическая конфигурация, позволяющая в реальном времени подключать и отключать новые банки
- статическая конфигурация переменными окружения для разработки
- docker compose c бэкендом и redis

## полуфинал

- доработать объединённые транзакции
- добавить другие фичи по кроссбанковому анализу данных
- реализовать работу с разрешениями на платежи
- добавить поддержку других провайдеров конфигурации, например, etcd
- добавить фронтенд в docker compose

## дальше

- корректная работа с разными версиями OpenBanking API
